(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const e of o)if(e.type==="childList")for(const l of e.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function s(o){const e={};return o.integrity&&(e.integrity=o.integrity),o.referrerPolicy&&(e.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?e.credentials="include":o.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function r(o){if(o.ep)return;o.ep=!0;const e=s(o);fetch(o.href,e)}})();async function x(){if(window.__PRODUCT_CACHE)return window.__PRODUCT_CACHE;try{const t=await fetch("/data.json");if(!t.ok)return console.error("Failed to load data.json:",t.status),[];const n=await t.json();let s=[];try{const e=await fetch("/data-story.json");e.ok&&(s=await e.json())}catch(e){console.log("Story data not available:",e.message)}let r=[];try{const e=await fetch("/data-gallery.json");e.ok&&(r=await e.json())}catch(e){console.log("Gallery data not available:",e.message)}const o=[...n,...s,...r];return o.forEach(e=>{e.specialOrder&&(e.price=e.price||0),e.type||(e.type="original")}),window.__PRODUCT_CACHE=o,console.log(`Loaded ${o.length} total products (${n.length} base, ${s.length} story, ${r.length} gallery)`),o}catch(t){return console.error("Error loading products:",t),[]}}await x();const j=t=>Array.from(document.querySelectorAll(t)),P=document.querySelector(".nav-toggle");if(P){const t=document.getElementById("navMenu");P.hasAttribute("aria-expanded")||P.setAttribute("aria-expanded","false"),t&&!t.hasAttribute("aria-expanded")&&t.setAttribute("aria-expanded","false"),P.addEventListener("click",()=>{const n=P.getAttribute("aria-expanded")==="true";P.setAttribute("aria-expanded",String(!n)),t?.setAttribute("aria-expanded",String(!n))}),t?.addEventListener("click",n=>{n.target.closest("a")&&(P.setAttribute("aria-expanded","false"),t.setAttribute("aria-expanded","false"))})}const T=document.getElementById("year");T&&(T.textContent=new Date().getFullYear());const A=document.getElementById("featuredCollections"),M=[{slug:"healing",title:"Healing & Resilience",img:"/images/angels-set-of-3.jpg",desc:"Art inspired by overcoming COPD & fibromyalgia."},{slug:"florida",title:"Florida Inspirations",img:"/images/lighthouse-big-red.jpg",desc:"Sun-kissed coastal & inland color stories."},{slug:"murals",title:"Murals & Commissions",img:"/images/pumpkin-man.jpg",desc:"Transform walls into immersive narratives."}];async function k(){const t=document.getElementById("newProducts");t&&(await x()).slice(0,6).forEach(s=>t.appendChild(B(s))),await S();try{const n=document.getElementById("heroImage");if(n){const s=typeof v=="function"?v("/images/heroimage.png","Hero image",!0):"<img src='/images/heroimage.png' alt='Hero image' loading='eager'>";n.innerHTML=s}}catch{}A&&(A.innerHTML=M.map(n=>`<article class='card'>${typeof v=="function"?v(n.img,`${n.title} preview`,!1):`<img src='${n.img}' alt='${n.title} preview' loading='lazy' />`}<h3>${n.title}</h3><p>${n.desc}</p><a class='btn secondary' href='/collections.html#${n.slug}'>Explore</a></article>`).join(""))}function B(t){const n=document.createElement("article");n.className="product-card";const s=t.specialOrder?"<span class='badge badge-special'>SPECIAL ORDER</span>":t.type==="original"?"<span class='badge badge-original'>ORIGINAL</span>":"<span class='badge badge-print'>PRINT</span>",r=`<img src='${t.image}' alt='${t.alt||t.title}' loading='lazy' decoding='async' style='width: 100%; height: 200px; object-fit: cover;'>`,o=`$${Number(t.price).toFixed(2)}`,e=`<button class='add-to-cart-btn' onclick='window.cart.addItem(${JSON.stringify(t).replace(/"/g,"&quot;")})'>Add to Cart</button>`;return n.innerHTML=`${s}${r}<h3>${t.title}</h3><div class='price'>${o}</div><div class='meta'>${t.type||"print"} • ${t.size}</div><a class='btn ghost' href='/product.html?id=${encodeURIComponent(t.id)}'>Details</a>${e}`,n}let $=null;async function S(){if($!==null)return $;try{const t=await fetch("/images/responsive-manifest.json");return t.ok?($=await t.json(),$):$={}}catch{return $={},$}}function v(t,n,s=!1){const r=t.split("/").pop(),e=($||{})[r];if(!e||!e.variants||e.variants.length===0)return`<img src='${t}' alt='${n}' loading='lazy' decoding='async' ${s?"fetchpriority='high'":""}>`;const l=e.variants.filter(a=>a.format==="webp"&&a.width&&a.file).sort((a,i)=>a.width-i.width),d=e.variants.filter(a=>a.format==="jpg"&&a.width&&a.file).sort((a,i)=>a.width-i.width);if(l.length===0&&d.length===0)return`<img src='${t}' alt='${n}' loading='lazy' decoding='async' ${s?"fetchpriority='high'":""}>`;const p=a=>a.map(i=>`/images/${i.file} ${i.width}w`).join(", "),g=d.length>0?p(d):"",E=l.length>0?p(l):"",w=d.length>0?`/images/${d[d.length-1].file}`:l.length>0?`/images/${l[l.length-1].file}`:t;return`<picture>${E?`<source type='image/webp' srcset='${E}' sizes='(max-width:1200px) 100vw, 1200px'>`:""}${g?`<source type='image/jpeg' srcset='${g}' sizes='(max-width:1200px) 100vw, 1200px'>`:""}<img src='${w}' alt='${n}' loading='lazy' decoding='async' ${s?"fetchpriority='high'":""}></picture>`}async function H(){if(document.body.dataset.page!=="shop")return;const t=document.getElementById("productGrid"),n=document.getElementById("filterType"),s=document.getElementById("filterCollection"),r=document.getElementById("sort"),o=await x();let e=1;const l=24;let d=[];function p(){let a=[...o];switch(a=a.filter(i=>!(!i.price||i.price<=0||i.type==="gallery")),r.value){case"priceLow":a.sort((i,u)=>i.price-u.price);break;case"priceHigh":a.sort((i,u)=>u.price-i.price);break;default:a.sort((i,u)=>i.title.localeCompare(u.title))}n.value&&(a=a.filter(i=>i.type===n.value)),s.value&&(a=a.filter(i=>(i.collections||[]).includes(s.value))),d=a,e=1,g(),E()}function g(){const a=(e-1)*l,i=a+l,u=d.slice(a,i);t.innerHTML=u.map(m=>B(m).outerHTML).join("")}function E(){const a=Math.ceil(d.length/l),i=document.getElementById("prevPage"),u=document.getElementById("nextPage"),m=document.getElementById("pageNumbers"),y=document.getElementById("paginationInfo");i.disabled=e===1,u.disabled=e===a,m.innerHTML="";const f=5;let c=Math.max(1,e-Math.floor(f/2)),h=Math.min(a,c+f-1);h-c+1<f&&(c=Math.max(1,h-f+1));for(let C=c;C<=h;C++){const L=document.createElement("button");L.className=`page-number ${C===e?"active":""}`,L.textContent=C,L.addEventListener("click",()=>w(C)),m.appendChild(L)}const b=(e-1)*l+1,I=Math.min(e*l,d.length);y.textContent=`Showing ${b}-${I} of ${d.length} products`}function w(a){e=a,g(),E(),t.scrollIntoView({behavior:"smooth",block:"start"})}[n,s,r].forEach(a=>a?.addEventListener("change",p)),document.getElementById("prevPage")?.addEventListener("click",()=>{e>1&&w(e-1)}),document.getElementById("nextPage")?.addEventListener("click",()=>{const a=Math.ceil(d.length/l);e<a&&w(e+1)}),p()}async function N(){if(!location.pathname.endsWith("/product.html"))return;const n=new URLSearchParams(location.search).get("id"),r=(await x()).find(p=>p.id===n),o=document.getElementById("productDetail");if(!o)return;if(!r){o.innerHTML="<p>Product not found.</p>";return}await S();const e=`<img src='${r.image}' alt='${r.alt||r.title}' style='max-width: 100%; height: auto; max-height: 500px; object-fit: contain;'>`,l=r.price>0?`$${Number(r.price).toFixed(2)}`:"Contact for Price",d=r.price>0?`<button class='btn primary' onclick='addToCartAndCheckout("${r.id}", "${r.title}", ${r.price})'>Add to Cart & Checkout</button>`:`<a class='btn primary' href='/contact.html?subject=Inquiry: ${encodeURIComponent(r.title)}'>Contact for Price</a>`;o.innerHTML=`
    <div class='detail-layout'>
      <div class='media'>${e}</div>
      <div class='info'>
        <h1>${r.title}</h1>
        <p class='price'>${l}</p>
        <p>${r.alt||r.title}</p>
        <div class='product-actions'>
          ${d}
          <a class='btn secondary' href='/shop.html'>Back to Shop</a>
        </div>
        <div id='payment-container' class='payment-container' style='display: none;'></div>
      </div>
    </div>
  `}async function R(){if(document.body.dataset.page!=="gallery")return;const t=document.getElementById("galleryGrid");let s=(await x()).filter(a=>!!(a.price===0||a.type==="gallery"||a.title&&a.title.includes("Charmin's Artwork")));const o=new URLSearchParams(window.location.search).get("collection");if(o)try{const u=(await(await fetch("/data-collections.json")).json()).find(m=>m.id===o);if(u&&u.galleryItems){s=u.galleryItems.map(y=>({id:y.id,title:y.title,image:y.image,alt:y.alt,price:0,size:"Various",type:"gallery",category:"Gallery"})),document.title=`${u.title} Collection – Art with Heart & Gifts`;const m=document.createElement("div");m.className="collection-header",m.innerHTML=`
          <h1>${u.title} Collection</h1>
          <p>${u.description}</p>
          <p class="collection-count">${u.galleryCount} artworks in this collection</p>
          <a href="/collections.html" class="btn secondary">← Back to Collections</a>
        `,t.parentNode.insertBefore(m,t)}}catch(a){console.error("Error loading collection:",a)}async function e(a){const i=new Map,u=async c=>{try{return(await fetch(c,{method:"HEAD"})).ok}catch{return!1}},m=location.origin,y=location.href,f=Array.from(new Set(a.map(c=>c.image).filter(Boolean)));await Promise.all(f.map(async c=>{if(i.has(c))return;let h=await u(c.startsWith("http")?c:new URL(c,y).href);if(h)return i.set(c,c);try{const b=c.startsWith("/")?`/public${c}`:`/public/${c}`;if(h=await u(new URL(b,m).href),h)return i.set(c,new URL(b,m).href)}catch{}try{const I=`/images/${c.split("/").pop()}`;if(h=await u(new URL(I,m).href),h)return i.set(c,new URL(I,m).href)}catch{}i.set(c,c)})),a.forEach(c=>{c&&c.image&&i.has(c.image)&&(c.image=i.get(c.image))})}await e(s),await S();const l=document.getElementById("galleryControlsTop"),d=document.getElementById("galleryControlsBottom");let p=Number(localStorage.getItem("gallery_page_size")||25),g=1;function E(a){const i=Math.max(1,Math.ceil(a/p)),u=`<div class='page-info'>Page ${g} of ${i} (${a} items)</div>`,m=`<div class='pager'>
      <button data-action='first' ${g===1?"disabled":""}>&laquo;</button>
      <button data-action='prev' ${g===1?"disabled":""}>&lsaquo;</button>
      <span class='pager-pages'>${Array.from({length:i}).map((y,f)=>`<button data-page='${f+1}' ${f+1===g?'aria-current="true"':""}>${f+1}</button>`).join("")}</span>
      <button data-action='next' ${g===i?"disabled":""}>&rsaquo;</button>
      <button data-action='last' ${g===i?"disabled":""}>&raquo;</button>
    </div>`;l.innerHTML=`<div class="pagination-container">${u}${m}</div>`,d.innerHTML=`<div class="pagination-container">${u}${m}</div>`,[l,d].forEach(y=>y.addEventListener("click",f=>{const c=f.target.closest("button");if(!c)return;const h=c.getAttribute("data-action"),b=c.getAttribute("data-page");h==="first"?g=1:h==="prev"?g=Math.max(1,g-1):h==="next"?g=Math.min(i,g+1):h==="last"?g=i:b&&(g=Number(b)),w()}))}function w(){let a=[...s];const i=a.length,u=Math.max(1,Math.ceil(i/p));g>u&&(g=u);const m=(g-1)*p,y=a.slice(m,m+p);t.innerHTML=y.map((f,c)=>{const h=c<3,b=typeof v=="function"?v(f.image,f.alt||f.title,h):`<img src='${f.image}' alt='${f.alt||f.title}' loading='lazy' decoding='async' ${h?"fetchpriority='high'":""}>`;return document.body.dataset.page==="gallery"?`
            <div class="masonry-item">
              ${b}
            </div>
          `:`<article class='product-card'>${b}</article>`}).join(""),E(i)}w()}(async()=>{await Promise.all([k(),H(),N(),R()]);try{await O()}catch{}})();async function O(){await S(),Array.from(document.querySelectorAll("img")).forEach(n=>{try{if(!n.src)return;const s=n.getAttribute("src")||"";if(!s.includes("/images/")||n.classList.contains("site-logo")||s.includes("Logo")||s.includes("vite.svg"))return;const r=n.getAttribute("alt")||"",e=(n.getAttribute("loading")||"")==="eager"||n.getAttribute("fetchpriority")==="high",l=typeof v=="function"?v(s,r,e):null;if(!l)return;const d=document.createElement("span");d.innerHTML=l;const p=d.firstElementChild;if(!p)return;n.className&&typeof n.className=="string"&&(p.className=n.className),n.replaceWith(p)}catch{}})}j("form#contactForm").forEach(t=>{t.addEventListener("submit",async n=>{n.preventDefault();const s=new FormData(t),r=Object.fromEntries(s.entries()),o=t.querySelector('button[type="submit"]'),e=o.textContent;o.textContent="Sending...",o.disabled=!0;try{const d=await(await fetch("https://art-with-heart-and-gifts-llc-production.up.railway.app/api/contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).json();d.success?(alert("Thank you! Your message has been sent successfully. We'll get back to you within 24 hours."),t.reset()):alert(`Error: ${d.error||"Failed to send message. Please try again."}`)}catch(l){console.error("Contact form error:",l),alert("Sorry, there was an error sending your message. Please try again or contact us directly at artwithheartandgifts@yahoo.com")}finally{o.textContent=e,o.disabled=!1}})});j("form#commissionForm").forEach(t=>{t.addEventListener("submit",async n=>{n.preventDefault();const s=new FormData(t),r=Object.fromEntries(s.entries()),o={name:r.name,email:r.email,phone:r.phone,projectType:r.type,budget:r.budget,timeline:r.timeline,description:r.theme,dimensions:r.dimensions,location:r.location,additional:r.additional},e=t.querySelector('button[type="submit"]'),l=e.textContent;e.textContent="Sending...",e.disabled=!0;try{const p=await(await fetch("https://art-with-heart-and-gifts-llc-production.up.railway.app/api/commission",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).json();p.success?(alert("Thank you! Your commission inquiry has been sent successfully. We'll get back to you within 24 hours to discuss your project."),t.reset()):alert(`Error: ${p.error||"Failed to send inquiry. Please try again."}`)}catch(d){console.error("Commission form error:",d),alert("Sorry, there was an error sending your inquiry. Please try again or contact us directly at artwithheartandgifts@yahoo.com")}finally{e.textContent=l,e.disabled=!1}})});j("form#newsletterForm").forEach(t=>{t.addEventListener("submit",async n=>{n.preventDefault();const s=new FormData(t),r=Object.fromEntries(s.entries()),o=t.querySelector('button[type="submit"]'),e=o.textContent;o.textContent="Subscribing...",o.disabled=!0;try{const l={name:"Newsletter Subscriber",email:r.email,subject:"Newsletter Signup",message:"New newsletter subscription request",inquiryType:"Newsletter"},p=await(await fetch("https://art-with-heart-and-gifts-llc-production.up.railway.app/api/contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)})).json();p.success?(alert("Thank you for subscribing! You'll receive updates about new art releases and special offers."),t.reset()):alert(`Error: ${p.error||"Failed to subscribe. Please try again."}`)}catch(l){console.error("Newsletter signup error:",l),alert("Sorry, there was an error with your subscription. Please try again or contact us directly at artwithheartandgifts@yahoo.com")}finally{o.textContent=e,o.disabled=!1}})});window.showPaymentForm=async function(t,n,s){const r=document.getElementById("payment-container");if(r){r.style.display="block",r.innerHTML='<div class="loading">Setting up payment...</div>';try{window.paymentProcessor?await window.paymentProcessor.setupPaymentForm("payment-container",s,{id:t,title:n,price:s}):r.innerHTML=window.paymentProcessor?.showAlternativePayment({id:t,title:n,price:s})||`
        <div class="payment-error">
          <h3>Payment Unavailable</h3>
          <p>Please contact us directly to complete your purchase.</p>
          <a href="/contact.html?subject=Purchase: ${encodeURIComponent(n)}" class="btn primary">Contact Us</a>
        </div>
      `}catch(o){console.error("Payment setup error:",o),r.innerHTML=`
      <div class="payment-error">
        <h3>Payment Setup Error</h3>
        <p>We're having trouble setting up payment. Please contact us directly.</p>
        <a href="/contact.html?subject=Purchase: ${encodeURIComponent(n)}" class="btn primary">Contact Us</a>
      </div>
    `}}};export{x as l};
